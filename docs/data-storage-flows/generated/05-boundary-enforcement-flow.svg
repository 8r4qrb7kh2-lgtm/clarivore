<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 1861.61px; background-color: white;" viewBox="0 0 1861.609375 1109" role="graphics-document document" aria-roledescription="flowchart-v2"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"><g class="cluster" id="BOUNDARY" data-look="classic"><rect style="" x="1441.765625" y="8" width="411.84375" height="956"/><g class="cluster-label" transform="translate(1588.171875, 8)"><foreignObject width="119.03125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Protected Tables</p></span></div></foreignObject></g></g><g class="cluster" id="ENFORCER" data-look="classic"><rect style="" x="419.15625" y="30" width="928.796875" height="1040"/><g class="cluster-label" transform="translate(825.8203125, 30)"><foreignObject width="115.46875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>DB Enforcement</p></span></div></foreignObject></g></g><g class="cluster" id="WRITERS" data-look="classic"><rect style="" x="8" y="280" width="361.15625" height="516"/><g class="cluster-label" transform="translate(128.1796875, 280)"><foreignObject width="120.796875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Potential Writers</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path d="M344.156,414L348.323,414C352.49,414,360.823,414,369.156,414C377.49,414,385.823,414,394.156,414C402.49,414,410.823,414,441.285,427.856C471.746,441.712,524.336,469.424,550.631,483.279L576.926,497.135" id="L_W1_E1_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_W1_E1_0" data-points="W3sieCI6MzQ0LjE1NjI1LCJ5Ijo0MTR9LHsieCI6MzY5LjE1NjI1LCJ5Ijo0MTR9LHsieCI6Mzk0LjE1NjI1LCJ5Ijo0MTR9LHsieCI6NDE5LjE1NjI1LCJ5Ijo0MTR9LHsieCI6NTgwLjQ2NDUyODcyOTgzODcsInkiOjQ5OX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M864.797,538L868.964,538C873.13,538,881.464,538,889.13,538C896.797,538,903.797,538,907.297,538L910.797,538" id="L_E1_E2_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E1_E2_0" data-points="W3sieCI6ODY0Ljc5Njg3NSwieSI6NTM4fSx7IngiOjg4OS43OTY4NzUsInkiOjUzOH0seyJ4Ijo5MTQuNzk2ODc1LCJ5Ijo1Mzh9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1143.839,487L1177.858,417.5C1211.877,348,1279.915,209,1321.752,139.5C1363.589,70,1379.224,70,1394.859,70C1410.495,70,1426.13,70,1455.842,70C1485.555,70,1529.344,70,1551.238,70L1573.133,70" id="L_E2_B1_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E2_B1_0" data-points="W3sieCI6MTE0My44Mzg2NDE4MjY5MjMsInkiOjQ4N30seyJ4IjoxMzQ3Ljk1MzEyNSwieSI6NzB9LHsieCI6MTM5NC44NTkzNzUsInkiOjcwfSx7IngiOjE0NDEuNzY1NjI1LCJ5Ijo3MH0seyJ4IjoxNTc3LjEzMjgxMjUsInkiOjcwfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1150.971,487L1183.801,434.833C1216.632,382.667,1282.292,278.333,1322.94,226.167C1363.589,174,1379.224,174,1394.859,174C1410.495,174,1426.13,174,1455.37,174C1484.609,174,1527.453,174,1548.875,174L1570.297,174" id="L_E2_B2_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E2_B2_0" data-points="W3sieCI6MTE1MC45NzExMTA5MjAzMjk3LCJ5Ijo0ODd9LHsieCI6MTM0Ny45NTMxMjUsInkiOjE3NH0seyJ4IjoxMzk0Ljg1OTM3NSwieSI6MTc0fSx7IngiOjE0NDEuNzY1NjI1LCJ5IjoxNzR9LHsieCI6MTU3NC4yOTY4NzUsInkiOjE3NH1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1163.81,487L1194.5,452.167C1225.191,417.333,1286.572,347.667,1325.08,312.833C1363.589,278,1379.224,278,1394.859,278C1410.495,278,1426.13,278,1449.915,278C1473.701,278,1505.635,278,1521.603,278L1537.57,278" id="L_E2_B3_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E2_B3_0" data-points="W3sieCI6MTE2My44MDk1NTUyODg0NjE1LCJ5Ijo0ODd9LHsieCI6MTM0Ny45NTMxMjUsInkiOjI3OH0seyJ4IjoxMzk0Ljg1OTM3NSwieSI6Mjc4fSx7IngiOjE0NDEuNzY1NjI1LCJ5IjoyNzh9LHsieCI6MTU0MS41NzAzMTI1LCJ5IjoyNzh9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1193.766,487L1219.464,469.5C1245.162,452,1296.557,417,1330.073,399.5C1363.589,382,1379.224,382,1394.859,382C1410.495,382,1426.13,382,1447.284,382C1468.438,382,1495.109,382,1508.445,382L1521.781,382" id="L_E2_B4_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E2_B4_0" data-points="W3sieCI6MTE5My43NjU5MjU0ODA3NjkzLCJ5Ijo0ODd9LHsieCI6MTM0Ny45NTMxMjUsInkiOjM4Mn0seyJ4IjoxMzk0Ljg1OTM3NSwieSI6MzgyfSx7IngiOjE0NDEuNzY1NjI1LCJ5IjozODJ9LHsieCI6MTUyNS43ODEyNSwieSI6MzgyfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1322.953,491.675L1327.12,490.729C1331.286,489.783,1339.62,487.892,1351.604,486.946C1363.589,486,1379.224,486,1394.859,486C1410.495,486,1426.13,486,1449.762,486C1473.393,486,1505.021,486,1520.835,486L1536.648,486" id="L_E2_B5_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E2_B5_0" data-points="W3sieCI6MTMyMi45NTMxMjUsInkiOjQ5MS42NzQ5MTk4NTUzOTg3fSx7IngiOjEzNDcuOTUzMTI1LCJ5Ijo0ODZ9LHsieCI6MTM5NC44NTkzNzUsInkiOjQ4Nn0seyJ4IjoxNDQxLjc2NTYyNSwieSI6NDg2fSx7IngiOjE1NDAuNjQ4NDM3NSwieSI6NDg2fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1322.953,584.325L1327.12,585.271C1331.286,586.217,1339.62,588.108,1351.604,589.054C1363.589,590,1379.224,590,1394.859,590C1410.495,590,1426.13,590,1448.314,590C1470.497,590,1499.229,590,1513.595,590L1527.961,590" id="L_E2_B6_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E2_B6_0" data-points="W3sieCI6MTMyMi45NTMxMjUsInkiOjU4NC4zMjUwODAxNDQ2MDEzfSx7IngiOjEzNDcuOTUzMTI1LCJ5Ijo1OTB9LHsieCI6MTM5NC44NTkzNzUsInkiOjU5MH0seyJ4IjoxNDQxLjc2NTYyNSwieSI6NTkwfSx7IngiOjE1MzEuOTYwOTM3NSwieSI6NTkwfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1193.766,589L1219.464,606.5C1245.162,624,1296.557,659,1330.073,676.5C1363.589,694,1379.224,694,1394.859,694C1410.495,694,1426.13,694,1448.035,694C1469.94,694,1498.115,694,1512.202,694L1526.289,694" id="L_E2_B7_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E2_B7_0" data-points="W3sieCI6MTE5My43NjU5MjU0ODA3NjkzLCJ5Ijo1ODl9LHsieCI6MTM0Ny45NTMxMjUsInkiOjY5NH0seyJ4IjoxMzk0Ljg1OTM3NSwieSI6Njk0fSx7IngiOjE0NDEuNzY1NjI1LCJ5Ijo2OTR9LHsieCI6MTUzMC4yODkwNjI1LCJ5Ijo2OTR9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1163.81,589L1194.5,623.833C1225.191,658.667,1286.572,728.333,1325.08,763.167C1363.589,798,1379.224,798,1394.859,798C1410.495,798,1426.13,798,1442.098,798C1458.065,798,1474.365,798,1482.514,798L1490.664,798" id="L_E2_B8_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E2_B8_0" data-points="W3sieCI6MTE2My44MDk1NTUyODg0NjE1LCJ5Ijo1ODl9LHsieCI6MTM0Ny45NTMxMjUsInkiOjc5OH0seyJ4IjoxMzk0Ljg1OTM3NSwieSI6Nzk4fSx7IngiOjE0NDEuNzY1NjI1LCJ5Ijo3OTh9LHsieCI6MTQ5NC42NjQwNjI1LCJ5Ijo3OTh9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1150.971,589L1183.801,641.167C1216.632,693.333,1282.292,797.667,1322.94,849.833C1363.589,902,1379.224,902,1394.859,902C1410.495,902,1426.13,902,1437.448,902C1448.766,902,1455.766,902,1459.266,902L1462.766,902" id="L_E2_B9_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E2_B9_0" data-points="W3sieCI6MTE1MC45NzExMTA5MjAzMjk3LCJ5Ijo1ODl9LHsieCI6MTM0Ny45NTMxMjUsInkiOjkwMn0seyJ4IjoxMzk0Ljg1OTM3NSwieSI6OTAyfSx7IngiOjE0NDEuNzY1NjI1LCJ5Ijo5MDJ9LHsieCI6MTQ2Ni43NjU2MjUsInkiOjkwMn1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M318.578,662L327.008,662C335.438,662,352.297,662,364.893,662C377.49,662,385.823,662,394.156,662C402.49,662,410.823,662,441.285,648.144C471.746,634.288,524.336,606.576,550.631,592.721L576.926,578.865" id="L_W2_E1_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_W2_E1_0" data-points="W3sieCI6MzE4LjU3ODEyNSwieSI6NjYyfSx7IngiOjM2OS4xNTYyNSwieSI6NjYyfSx7IngiOjM5NC4xNTYyNSwieSI6NjYyfSx7IngiOjQxOS4xNTYyNSwieSI6NjYyfSx7IngiOjU4MC40NjQ1Mjg3Mjk4Mzg3LCJ5Ijo1Nzd9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1141.693,589L1176.07,665.833C1210.447,742.667,1279.2,896.333,1321.394,973.167C1363.589,1050,1379.224,1050,1394.859,1050C1410.495,1050,1426.13,1050,1445.935,1050C1465.74,1050,1489.714,1050,1501.701,1050L1513.688,1050" id="L_E2_ERR_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_E2_ERR_0" data-points="W3sieCI6MTE0MS42OTMzMjg4NTc0MjE5LCJ5Ijo1ODl9LHsieCI6MTM0Ny45NTMxMjUsInkiOjEwNTB9LHsieCI6MTM5NC44NTkzNzUsInkiOjEwNTB9LHsieCI6MTQ0MS43NjU2MjUsInkiOjEwNTB9LHsieCI6MTUxNy42ODc1LCJ5IjoxMDUwfV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_W1_E1_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_E1_E2_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1394.859375, 70)"><g class="label" data-id="L_E2_B1_0" transform="translate(-19.171875, -12)"><foreignObject width="38.34375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>allow</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1394.859375, 174)"><g class="label" data-id="L_E2_B2_0" transform="translate(-19.171875, -12)"><foreignObject width="38.34375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>allow</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1394.859375, 278)"><g class="label" data-id="L_E2_B3_0" transform="translate(-19.171875, -12)"><foreignObject width="38.34375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>allow</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1394.859375, 382)"><g class="label" data-id="L_E2_B4_0" transform="translate(-19.171875, -12)"><foreignObject width="38.34375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>allow</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1394.859375, 486)"><g class="label" data-id="L_E2_B5_0" transform="translate(-19.171875, -12)"><foreignObject width="38.34375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>allow</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1394.859375, 590)"><g class="label" data-id="L_E2_B6_0" transform="translate(-19.171875, -12)"><foreignObject width="38.34375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>allow</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1394.859375, 694)"><g class="label" data-id="L_E2_B7_0" transform="translate(-19.171875, -12)"><foreignObject width="38.34375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>allow</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1394.859375, 798)"><g class="label" data-id="L_E2_B8_0" transform="translate(-19.171875, -12)"><foreignObject width="38.34375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>allow</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1394.859375, 902)"><g class="label" data-id="L_E2_B9_0" transform="translate(-19.171875, -12)"><foreignObject width="38.34375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>allow</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_W2_E1_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(1394.859375, 1050)"><g class="label" data-id="L_E2_ERR_0" transform="translate(-21.90625, -12)"><foreignObject width="43.8125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>reject</p></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-W1-0" transform="translate(188.578125, 414)"><rect class="basic label-container" style="" x="-155.578125" y="-99" width="311.15625" height="198"/><g class="label" style="" transform="translate(-125.578125, -84)"><rect/><foreignObject width="251.15625" height="168"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Gateway tx path\n(setRestaurantWriteContext 9393)\nUsers: manager/owner with restaurant access, app admin, system key\nPage/surface: /restaurant, /admin-dashboard, cron/system</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-W2-1" transform="translate(188.578125, 662)"><rect class="basic label-container" style="" x="-130" y="-99" width="260" height="198"/><g class="label" style="" transform="translate(-100, -84)"><rect/><foreignObject width="200" height="168"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Direct SQL/Prisma/Supabase write\n(no gateway context)\nUsers: any caller bypassing gateway\nPage/surface: any non-gateway entry</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-E1-2" transform="translate(654.4765625, 538)"><rect class="basic label-container" style="" x="-210.3203125" y="-39" width="420.640625" height="78"/><g class="label" style="" transform="translate(-180.3203125, -24)"><rect/><foreignObject width="360.640625" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Trigger function:\nenforce_restaurant_gateway_context()</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-E2-3" transform="translate(1118.875, 538)"><rect class="basic label-container" style="" x="-204.078125" y="-51" width="408.15625" height="102"/><g class="label" style="" transform="translate(-174.078125, -36)"><rect/><foreignObject width="348.15625" height="72"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Check current_setting('app.restaurant_write_context') == 'gateway'</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-B1-4" transform="translate(1647.6875, 70)"><rect class="basic label-container" style="" x="-70.5546875" y="-27" width="141.109375" height="54"/><g class="label" style="" transform="translate(-40.5546875, -12)"><rect/><foreignObject width="81.109375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>restaurants</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-B2-5" transform="translate(1647.6875, 174)"><rect class="basic label-container" style="" x="-73.390625" y="-27" width="146.78125" height="54"/><g class="label" style="" transform="translate(-43.390625, -12)"><rect/><foreignObject width="86.78125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>change_logs</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-B3-6" transform="translate(1647.6875, 278)"><rect class="basic label-container" style="" x="-106.1171875" y="-27" width="212.234375" height="54"/><g class="label" style="" transform="translate(-76.1171875, -12)"><rect/><foreignObject width="152.234375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>dish_ingredient_rows</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-B4-7" transform="translate(1647.6875, 382)"><rect class="basic label-container" style="" x="-121.90625" y="-27" width="243.8125" height="54"/><g class="label" style="" transform="translate(-91.90625, -12)"><rect/><foreignObject width="183.8125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>dish_ingredient_allergens</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-B5-8" transform="translate(1647.6875, 486)"><rect class="basic label-container" style="" x="-107.0390625" y="-27" width="214.078125" height="54"/><g class="label" style="" transform="translate(-77.0390625, -12)"><rect/><foreignObject width="154.078125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>dish_ingredient_diets</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-B6-9" transform="translate(1647.6875, 590)"><rect class="basic label-container" style="" x="-115.7265625" y="-27" width="231.453125" height="54"/><g class="label" style="" transform="translate(-85.7265625, -12)"><rect/><foreignObject width="171.453125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>restaurant_menu_pages</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-B7-10" transform="translate(1647.6875, 694)"><rect class="basic label-container" style="" x="-117.3984375" y="-27" width="234.796875" height="54"/><g class="label" style="" transform="translate(-87.3984375, -12)"><rect/><foreignObject width="174.796875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>restaurant_menu_dishes</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-B8-11" transform="translate(1647.6875, 798)"><rect class="basic label-container" style="" x="-153.0234375" y="-27" width="306.046875" height="54"/><g class="label" style="" transform="translate(-123.0234375, -12)"><rect/><foreignObject width="246.046875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>restaurant_menu_ingredient_rows</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-B9-12" transform="translate(1647.6875, 902)"><rect class="basic label-container" style="" x="-180.921875" y="-27" width="361.84375" height="54"/><g class="label" style="" transform="translate(-150.921875, -12)"><rect/><foreignObject width="301.84375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>restaurant_menu_ingredient_brand_items</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-ERR-36" transform="translate(1647.6875, 1050)"><rect class="basic label-container" style="" x="-130" y="-51" width="260" height="102"/><g class="label" style="" transform="translate(-100, -36)"><rect/><foreignObject width="200" height="72"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>ERROR 42501:\nDirect write blocked; use unified restaurant write gateway</p></span></div></foreignObject></g></g></g></g></g></svg>